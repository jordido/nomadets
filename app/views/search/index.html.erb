<%= form_for @search do |s| %>
  <div class="form-group">
    <%= s.label :country_id %>
    <%= s.collection_select(nil, :country_id,  @countries,  :id, :name, {:prompt   => "Select a Country"}, {:id => 'countries_select'}) if @countries %>
  </div>
  <div class="form-group">
    <%= s.label :region_id %>
    <%= s.collection_select(nil, :region_id, @regions, :id, :name, {:prompt   => "Select a Region"}, {:id => 'regions_select'}) if @regions %>
  <div class="form-group">
    <%= s.label :city_id %>
    <%= collection_select(nil, :city_id, @cities, :id, :name, {:prompt   => "Select a City"}, {:id => 'cities_select'}) if @cities %>
  </div>
  <div>
    <%= u.submit class: "btn btn-success"%>
  </div>
<% end %>
 
<script>
//  $(document).ready(function() {
    $('#countries_select').change(function() {
      $.ajax({
        url: "<%= update_regions_path %>",
        type: "GET",
        data: {
          country_id : $('#countries_select').val()
        },
        dataType: "script",
        success: alert("countries select called")
      }).done(function (){ 
              alert("Select Region now");
            $('#regions_select').change(function() {
              $.ajax({
                url: "<%= update_cities_path %>",
                type: "GET",
                data: {
                  region_id : $('#regions_select').val()
                },
                dataType: "script",
                success: alert("regions select called")
              }).done(function (){ alert("regions done")});
            });
          });
    });   
//  });
</script>

